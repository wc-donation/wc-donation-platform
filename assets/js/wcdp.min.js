jQuery(function(d){if(document.querySelector("#wcdp")){let c,e=(d("#wcdp-ajax-send").on("submit",function(e){e.preventDefault();e=d("#wcdp-ajax-send").serialize();c!=e?(c=e,r("2")):l(2)}),0),a=(d(".wcdp-body > #wcdp-ajax-send").on("input blur keyup paste change",function(){c!=d("#wcdp-ajax-send").serialize()&&(e++,c=d("#wcdp-ajax-send").serialize(),setTimeout(function(){0==--e&&r()},1300))}),0),o=0,n=(d(".wcdp-body").on("input blur keyup paste change load",function(){let e=document.querySelector(".wcdp-body .single_add_to_cart_button");var t=document.querySelector("#wcdp-get-send");e&&t&&t.checkValidity()?e.classList.remove("disabled"):e&&e.classList.add("disabled"),d(".wcdp-express-amount").val(d("#wcdp-donation-amount").val()),a++,setTimeout(function(){0==--a&&o!=d("#wcdp-donation-amount").val()&&(o=d("#wcdp-donation-amount").val(),d(document.body).trigger("woocommerce_variation_has_changed"),e)&&e.classList.toggle("wcdp_price_changed")},500)}),1),t=(d(".wcdp-form .wcdp-button, .wcdp-step").click(function(){var e,t=d(this).attr("value");1!=n?l(t):1!=t&&p("#wcdp-ajax-send")&&(e=d("#wcdp-ajax-send").serialize(),(c!=e?(c=e,r):l)(t))}),10);d(document).ready(function(){d(".wcdp-loader")?.hide(),d(".wc-donation-platform")?.css({visibility:"visible","animation-name":"wcdp-appear-animation","animation-duration":"1s"}),h(!1);try{0!=d("#wcdp-donation-amount")?.val()&&d("#wcdp-ajax-send")?.trigger("change"),d(".wcdp-choose-donation")[0].checkValidity()&&(c=d("#wcdp-ajax-send")?.serialize(),r()),d("form.woocommerce-checkout select")?.selectWoo()}finally{d("#wcdp-ajax-send,.wcdp_options")?.trigger("change"),setTimeout(u,t)}}),window.onhashchange=function(){h(!1)},d(".wcdp-modal-open")?.click(function(){h(!0)}),d(document).on("keypress","input",function(e){"Escape"==e.key&&w()}),d(".wcdp-modal-close")?.click(w);var i=!1;function r(t){var e,c;p("#wcdp-ajax-send")&&(d("#wcdp-spinner").show(),d("#wcdp-ajax-button").hide(),c=(e=d("#wcdp-ajax-send")).serialize(),d.ajax({type:"POST",url:e.attr("action"),data:c}).done(function(e){!0===e.success?(d(".woocommerce-error").remove(),d("body").trigger("update_checkout"),d("#wcdp-ajax-button").show(),d("#wcdp-spinner").hide(),e.recurring?(d("#createaccount").prop("checked",!0).trigger("change"),d(".create-account:has(#createaccount)").hide()):d(".create-account:has(#createaccount)").show(),l(t)):s(e.message,e.reload,e.newParams)}).fail(function(){d("#wcdp-spinner").hide(),s(d(".wcdp-choose-donation").attr("wcdp-error-default"))}))}function p(e){var t=d("#variation_id");try{return d(e)[0].reportValidity()&&(0===t.length||""!=t.attr("value"))}catch(e){}}function s(e="An unexpected error occurred. Please reload the page and try again. If the problem persists, please contact our support team.",t=!0,a=!1){if(t||d("#wcdp-ajax-button").show(),a){alert(e);let c=new URL(window.location.href);Object.entries(a).forEach(([e,t])=>c.searchParams.set(e,t)),window.location.href=c.toString()}d("#wcdp-spinner").hide(),d("#wcdp-ajax-error").remove(),d("form.checkout.woocommerce-checkout").prepend('<ul class="woocommerce-error" id="wcdp-ajax-error" role="alert"><li></li></ul>'),d("#wcdp-ajax-error li").text(e)}function l(e){var t=d(":root")[0];switch(t.style.setProperty("--wcdp-step-2","var(--wcdp-main)"),t.style.setProperty("--wcdp-step-3","var(--wcdp-main)"),e){case"3":d("#wcdp-step-2").show(),d("form.checkout").find(".input-text:visible, select:visible, input:checkbox:visible").trigger("validate"),0<d("#wcdp-step-2 .woocommerce-invalid:visible").length?(d("#wcdp-invalid-fields").show(),d("#place_order").hide()):(d("#wcdp-invalid-fields").hide(),d("#place_order").show()),t.style.setProperty("--wcdp-step-3","var(--wcdp-main-2)");case"2":t.style.setProperty("--wcdp-step-2","var(--wcdp-main-2)");break;case"1":break;default:return}d(".wcdp-style5-active")?.removeClass("wcdp-style5-active"),d("#wcdp-style5-step-"+e)?.addClass("wcdp-style5-active"),d("#wcdp-progress-bar")?.css("width",33.33*(parseInt(e)-1)+"%"),d(".wcdp-tab")?.hide(),d("#wcdp-step-"+e)?.show(),n=e}function u(){0<d("#wc-stripe-payment-request-button")?.children()?.length+d("#ppc-button, #ppc-button-ppcp-gateway")?.children()?.length?d(".wcdp-express-heading")?.show():t<1e4&&(t*=2,setTimeout(u,t))}function w(){i&&(d(".wcdp-overlay")?.hide(),d("body")?.css("overflow-y"," auto"),history.pushState("",document.title,window.location.pathname+window.location.search),i=!1)}function h(e){var t=d(".wcdp-overlay");(e||"#wcdp-form"==location.hash&&0<t.length)&&(t.show(),d("body")?.css("overflow-y","hidden"),i=!0)}d(".wcdp_options")?.change(function(){var e=this.attributes["wcdp-name"].value,t=d('input[name="'+e+'"]:checked')?.val();t&&(d("#wcdp-"+e).val(t),(e=d("#"+e)).val(t),e.trigger("change"))}),d(document).on("change",'#wcdp_fee_recovery, input[name="payment_method"]',function(){(d(this).is("#wcdp_fee_recovery")||d("#wcdp_fee_recovery").prop("checked"))&&setTimeout(()=>d("body").trigger("update_checkout"),400)}),d("#wcdp-range")?.on("input",function(){var e=d("#wcdp-range"),t=d("#wcdp-donation-amount");t.val(e.val()),e.val()==e.attr("max")&&t.select()}),d(".wcdp-amount-range-field")?.on("input",function(){d("#wcdp-range")?.val(d("#wcdp-donation-amount")?.val())}),d("#wcdp-donation-amount")?.on("change",function(){var e="#wcdp_value_"+d("#wcdp-donation-amount")?.val()?.replace(/./g,"-");(0==d(e)?.length?d("#wcdp_value_other"):d(e))?.prop("checked",!0)}),d("#wcdp_value_other")?.click(function(){d("#wcdp-donation-amount")?.focus()}),d(".wcdp-choose-donation")?.on("change",function(){d(".wcdp_su input")?.each(function(){0==d("#"+this.name+' option[value="'+this.value+'"]').length?this.setAttribute("disabled","true"):this.removeAttribute("disabled")})})}});
